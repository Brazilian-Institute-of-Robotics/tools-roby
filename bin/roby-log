#! /usr/bin/env ruby
require 'roby'
require 'roby/log/gui/replay'
app  = Qt::Application.new(ARGV)
main = Replay.setup(ARGV) do |main, parser, remaining|
    if remaining.empty?
	if main.log_dir
	    streams = Roby.app.data_streams(main.log_dir)
	    streams.each do |stream|
		main.add_stream(stream)
	    end
	else
	    STDERR.puts parser
	    exit(0)
	end
    else
	remaining.each do |file|
	    if streams = Roby.app.data_streams([file])
		streams.each { |s| main.add_stream(s) }
	    else
		STDERR.puts "WARN: unknown file type for #{file}"
	    end
	end
    end
end

main.setup
begin
    app.exec
rescue
    STDERR.puts $!.full_message
end


